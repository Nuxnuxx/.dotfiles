if ! tmux has-session -t staff-internal-app 2>/dev/null; then
    # Create a new tmux session and start in the specified directory
    tmux new-session -d -s staff-internal-app -c /home/gaetan/work/staff-internal-app

    # Send the first command to the first window (which is created by default with the session)
    tmux send-keys -t staff-internal-app "npm run dev" C-m

    # Create a new window and set the directory before sending the command
    tmux new-window -t staff-internal-app -n "artisan-serve" -c /home/gaetan/work/staff-internal-app
    tmux send-keys -t staff-internal-app:artisan-serve "php artisan serve" C-m

    # Create another window and set the directory before sending the command
    tmux new-window -t staff-internal-app -n "artisan-queue" -c /home/gaetan/work/staff-internal-app
    tmux send-keys -t staff-internal-app:artisan-queue "php artisan queue:listen --queue=emails,process_files,reply" C-m

    # Create the last window and set the directory before sending the command
    tmux new-window -t staff-internal-app -n "docker" -c /home/gaetan/work/staff-internal-app
    tmux send-keys -t staff-internal-app:docker "docker compose up -d" C-m
fi

# Check if running inside a tmux session
if [ -n "$TMUX" ]; then
    # If inside a tmux session, switch to the new session
    tmux switch-client -t staff-internal-app
else
    # If not inside a tmux session, attach to the session
    tmux attach-session -t staff-internal-app
fi
